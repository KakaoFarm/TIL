# 8.1 외부 API 설계 이슈

<b> FTGO 애플리케이션의 서비스 API를 소비하는 네 종류의 클라이언트 </b >

-   브라우저 기반의 일반 소비자 및 음식점 전용 UI, 내부 관리자용 UI가 구현된 웹 애플리케이션
-   브라우저에서 실행 중인 자바스크립트 애플리케이션
-   소비자용/배달원용 모바일 앱
-   서드파티 애플리케이션

<b>웹 애플리케이션</b>

-   일부 클라이언트는 방화벽 내부, 나머지는 외부에 위치
-   방화벽 외부 클라이언트는 저성능 인터넷/모바일 네트워크를 통해 방화벽 내부 클라이언트는 고성능 LAN을 통해 서비스에 접근

<b> 클라이언트가 서비스를 직접 호출하도록 API 설계 </b>

-   서비스 API가 잘게 나뉘어져 있어서 클라이언트가 필요한 데이터를 가져오려면 여러 번 요청을 해야 하고, 그만큼 효율이 떨어지고 UX는 나빠짐.
-   클라이언트가 서비스 및 API를 알아야 하는 구조라서 캡슐화가 되지 않고, 나중에 아키텍처와 API를 바꾸기 어려움.
-   클라이언트(특히 방화벽 외부에 있는 클라이언트)가 사용하기에 불편하거나 실용적이지 못한 IPC를 서비스에서 사용 중인 경우가 있음.

<br />

## 8.1.1 API 설계 이슈: FTGO 모바일 클라이언트

### 마이크로서비스 버전

-   주문 서비스: 기본 주문 정보(주문 내역, 주문 상태 등)
-   주방 서비스: 음식점 관점에서 주문 상태 및 픽업 준비를 마칠 예상 시간
-   배달 서비스: 주문 배달 상태, 예상 배달 시간, 현재 위치
-   회계 서비스: 주문 지불 상태

<b> 모놀리식 애플리케이션 클라이언트는 요청 한 번으로 주문 내역을 조회할 수 있지만, 마이크로서비스 아키텍처의 클라이언트는 요청을 여러 번 전송해야 한다.</b>

### 클라이언트가 요청을 여러 번 전송하기 때문에 UX가 나빠진다.

-   모바일 앱이 사용자에게 보여줄 데이터를 여러 번 요청해서 가져와야 한다.
-   인터넷은 LAN보다 대역폭이 훨씬 낮고 지연시간이 길다.
-   모바일 앱에서 클라이언트가 요청을 순차 실행할 수 밖에 없는 상황이라면 UX가 형편없이 나빠진다.
-   네트워크 지연으로 인해 모바일 개발자가 복잡한 API 조합 코드를 작성할 일이 많아지게 되면 UX를 개선해야 하는 본연의 임무를 달성하기 어려움.

### 캡슐화가 되지 않아 프런트엔드 개발자가 백엔드와 맞물려 코드를 변경해야 한다.

-   서비스에 관한 지식이 모바일 앱에 포함되어 있으면 서비스 API를 변경하기가 어려움.
-   새버전 출시했을 때 업그레이드를 바로 하지 않는 유저가 있을 경우.

### 클라이언트에 비친화적인 IPC를 사용 중인 클라이언트도 있다.

-   클라이언트가 소비하기 어려운 프로토콜을 사용하는 서비스도 있음.
-   내부에서는 잘 작동되지만, 모바일 클라이언트가 소비하기 어려운 경우, 방화벽에 친화적이지 않은 프로토콜도 있음.

<br />

## 8.1.2 API 설계 이슈: 다른 종류의 클라이언트

### 웹 애플리케이션

-   전통적인 서버 쪽 웹 애플리케이션은 브라우저에서 HTTP 요청을 받아 HTML 페이지를 반환하며, 방화벽 내부에서 실행되고 LAN을 통해 서비스에 접근.
-   API 조합로직을 구현하는 데 있어서 네트워크 대역폭과 지연 시간은 장애물이 아님.

### 브라우저 기반의 자바스크립트 애플리케이션

-   브라우저 기반의 자바스크립트 애플리케이션은 서비스 API 변경 시 업데이트하기는 쉽지만, 모바일 앱처럼 인터넷을 통해 서비스에 접근하기 때문에 네트워크 지연 문제는 차이가 없음.
-   일반 모바일 앱보다 더 정교한 브라우저 기반의 UI(데스크 톱 UI 등)는 더 많은 서비스를 조합해야 할 필요가 있음.

### 서드파티 애플리케이션

-   서드파티 개발자용 API를 제공할 경우 구 버전을 오랫동안 유지하는 경우가 흔함.
-   장기간 하위 호환성을 관리할 책임을 백엔드 서비스 개발자에게 지우기란 현실적으로 어려움.
-   서드파티 개발자에게 직접 서비스를 표출하는 대신 별도 팀에서 개발한 퍼블릭 API를 따로 가져가는 것이 좋음.
